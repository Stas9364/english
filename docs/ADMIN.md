# Создание квизов и страниц с ответами

Пошаговое руководство: как устроен квиз, как добавлять страницы, теорию и настраивать ответы.

---

## Как устроен квиз

- **Квиз** — это один тест (например, «Present Simple»).
- У квиза есть **название** и **описание** (описание показывается пользователю в начале).
- Квиз может содержать **теорию** — блоки текста и/или изображений, которые отображаются пользователю во вкладке «Theory» до или во время прохождения теста.
- Квиз состоит из **страниц**. Каждая страница — это один экран с заданиями.
- На каждой странице задаётся **тип ответа**: один вариант, несколько вариантов, ввод текста, выбор в пропусках (dropdown) или соответствие (matching).
- Внутри страницы — **вопросы**. У каждого вопроса свой текст и свои варианты ответов (или список правильных фраз, или пары для соответствия).

Схема: **Квиз → (опционально) Теория + Страницы → У каждой страницы тип + вопросы → У каждого вопроса варианты / правильные ответы / пары**.

---

## Создание нового квиза

### Шаг 1. Основные поля

- **Quiz title** (обязательно) — название квиза, например «Present Simple». Оно отображается на главной и в начале теста.
- **Description (optional)** — краткое описание или инструкция. Показывается пользователю перед началом и при необходимости на странице.

### Шаг 2. Страницы

Под полями квиза идёт блок **Pages**.

- У каждой страницы есть карточка **Page 1**, **Page 2** и т.д.
- Страниц должно быть **хотя бы одна**. Добавление новой страницы — кнопка **Add page** внизу блока «Pages».

В каждой карточке страницы настраивается:

1. **Page type** — тип ответов на этой странице:
   - **Single choice** — один правильный вариант (радиокнопки).
   - **Multiple choice** — несколько правильных вариантов (чекбоксы).
   - **Text input** — пользователь вводит текст в пропуски в предложении; правильность по списку допустимых ответов для каждого пропуска.
   - **Dropdown in gaps** — в предложении есть пропуски `[[]]`; в каждом пропуске пользователь выбирает один вариант из выпадающего списка; вы отмечаете, какой вариант правильный для каждого пропуска.
   - **Matching** — слева перетаскиваемые элементы, справа вопросы; пользователь сопоставляет каждый элемент слева с вопросом справа (drag and drop).
2. **Page title (optional)** — подзаголовок страницы, если нужен.
3. **Questions** — список вопросов на этой странице (см. ниже).

Иконка корзины рядом с заголовком страницы **удаляет страницу сразу после подтверждения** (запись удаляется в БД). Удалить можно только если страниц больше одной.

### Шаг 3. Вопросы внутри страницы

Внутри каждой страницы — блок **Questions**.

- Вопросов на странице должно быть **хотя бы один**.
- Новый вопрос — кнопка **Add question** внизу блока вопросов этой страницы.

У каждого вопроса заполняете:

- **Question text** (обязательно) — текст вопроса, например «Choose the correct form». Для **Text input** без `[[]]` будет одно поле для ответа; с `[[]]` — несколько полей в местах пропусков. Для **Dropdown in gaps** в тексте обязательно указывайте `[[]]` в местах выпадающих списков.
- **Explanation (optional)** — пояснение, которое показывается пользователю после проверки ответа.

Иконка корзины рядом с «Question 1», «Question 2» **удаляет вопрос сразу после подтверждения**. Удалить можно только если вопросов больше одного.

### Шаг 4. Варианты ответов (Single choice и Multiple choice)

Если у страницы тип **Single choice** или **Multiple choice**, у каждого вопроса есть блок **Options**.

- Каждый вариант — это поле с текстом и чекбокс **Correct**.
- **Single choice**: отметьте **Correct** только у одного варианта — это и будет правильный ответ.
- **Multiple choice**: отметьте **Correct** у всех вариантов, которые считаются правильными; пользователь должен выбрать все правильные.
- Кнопка **Add option** внизу списка вариантов добавляет новый вариант. Иконка корзины рядом с вариантом **удаляет его сразу после подтверждения**. Вариантов должно остаться **минимум один**.
- У каждого вопроса свой набор вариантов; они не связаны с другими вопросами.

### Шаг 5. Правильные ответы для Text input

Если у страницы тип **Text input**, у каждого вопроса вместо вариантов выбора показывается блок **Correct answers**.

**Два варианта использования:**

1. **Один общий ответ (без пропусков в тексте)**  
   Если в тексте вопроса **нет** `[[]]`, под вопросом отображается **одно поле ввода**. Пользователь вводит ответ в него (например, на вопрос «Переведите: яблоко» — вводит «apple»). В блоке **Correct answers** укажите все допустимые варианты ответа (например, «apple», «an apple»). Хотя бы один правильный ответ обязателен.

2. **Несколько пропусков в предложении**  
   Если в тексте вопроса есть `[[]]`, количество пропусков считается по числу `[[]]` (например: «She [[]] to school every day.» — один пропуск; «The cat [[]] on the [[]].» — два пропуска). Под вопросом показывается **столько полей ввода, сколько пропусков**. Появляются блоки **Correct answers for gap 1**, **Correct answers for gap 2** и т.д. — для каждого пропуска задаёте свой список допустимых фраз. Пользователь заполняет поля по порядку; каждое проверяется по своему списку (без учёта регистра).

- В каждом блоке — кнопка **Add correct answer** (или **Add correct answer for gap N** при нескольких пропусках). Иконка корзины удаляет строку после подтверждения. Для каждого пропуска (или для единственного ответа) должен остаться **хотя бы один** правильный ответ.

### Шаг 6. Варианты для Dropdown in gaps

Тип страницы **Dropdown in gaps** подходит, когда нужно вставить в предложение **выбор из списка** вместо ввода с клавиатуры: в каждом пропуске пользователь видит выпадающий список и выбирает один вариант.

**Как настроить**

1. **Текст вопроса** должен содержать `[[]]` в тех местах, где должен быть выпадающий список. Количество пропусков = количеству `[[]]`.  
   Пример: «She [[]] to school every day.» — один пропуск; «The cat [[]] on the [[]].» — два пропуска.

2. Ниже появятся блоки **Options for gap 1**, **Options for gap 2** и т.д. — по одному на каждый пропуск. Порядок блоков совпадает с порядком пропусков слева направо.

3. **В каждом блоке** задаёте варианты, которые будут в выпадающем списке для этого пропуска:
   - Поле с текстом варианта (например, «goes», «go», «went»).
   - Чекбокс **Correct** — отметьте его у всех вариантов, которые считаются правильным ответом для этого пропуска (можно несколько: например, «goes» и «go» оба правильные).
   - Кнопка **Add option for gap N** добавляет ещё один вариант в этот пропуск.
   - Иконка корзины удаляет вариант после подтверждения. В каждом пропуске должен остаться **хотя бы один вариант**, и **хотя бы один из них должен быть отмечен как Correct**.

4. Варианты для разных пропусков **не смешиваются**: то, что вы добавили в «Options for gap 1», показывается только в первом выпадающем списке; в «Options for gap 2» — только во втором и т.д.

**Пример.** Вопрос: «She [[]] to school. He [[]] to work.»  
- В **Options for gap 1** добавляете, например: «goes» (Correct), «go» (Correct), «went».  
- В **Options for gap 2** добавляете: «goes» (Correct), «go», «went».  
В квизе пользователь в первом пропуске выберет из первого списка, во втором — из второго; засчитается, если в каждом выбран вариант с галочкой Correct.

### Шаг 7. Пары для Matching

Если у страницы тип **Matching**, у каждого вопроса два поля:

- **Right column (question)** — текст, который пользователь увидит справа (цель для сопоставления), например «Apple».
- **Left column (matching item)** — элемент, который пользователь будет перетаскивать к этому вопросу, например «яблоко». Это правильная пара для данной строки.

- На странице квиза слева отображаются все «элементы слева» (перемешанные), справа — все «вопросы». Пользователь перетаскивает элемент к нужному вопросу. После проверки показывается, верно ли сопоставление (зелёный/красный).
- У каждого вопроса должна быть заполнена **хотя бы одна пара** (текст справа и элемент слева).

### Шаг 8. Теория (опционально)

Блок **Theory (optional)** позволяет добавить к квизу блоки теории до сохранения.

- Кнопки **Text** и **Image** добавляют блок: текстовый или с изображением.
- **Текст**: введите или вставьте текст в поле (поддерживается разметка).
- **Изображение**: нажмите **Upload** и выберите файл (JPEG, PNG, GIF, WebP) — он загрузится в хранилище и ссылка подставится автоматически; либо вставьте готовый URL в поле.
- Стрелки вверх/вниз меняют порядок блоков, иконка корзины **удаляет блок сразу после подтверждения** (для изображений из хранилища файл тоже удаляется).
- Теорию можно не заполнять при создании и добавить позже в режиме редактирования.

### Шаг 9. Сохранение

Нажмите **Create quiz**. После успешного сохранения появится сообщение «Quiz created successfully», форма очистится, а новый квиз появится в списке «Your quizzes» и на главной странице сайта.

---

## Редактирование квиза

1. На странице `/admin` в блоке **Your quizzes** нажмите иконку карандаша у нужного квиза.
2. Откроется форма редактирования с **двумя вкладками**: **Details and pages** и **Theory**.

### Вкладка «Details and pages»

- Поля **Quiz title**, **Description**, **Slug** (адрес квиза, например `/quiz/present-simple`).
- Блок **Pages** — как при создании: тип страницы, заголовок, вопросы; для каждого типа — свои поля (варианты, правильные ответы для Text input, варианты по пропускам для Dropdown in gaps, пары «справа / слева» для Matching).
- **Add page** / **Add question** / **Add option** (или **Add correct answer**) — добавление элементов.
- Иконки корзины **удаляют страницу, вопрос или вариант сразу после подтверждения** (изменения в БД и, для изображений теории, в хранилище применяются немедленно).
- Кнопка **Save changes** сохраняет изменения в названии, описании, slug, страницах и блоках теории (создание и редактирование). Удаления выполняются сразу при подтверждении, отдельно сохранять их не нужно.

### Вкладка «Theory»

- Блоки теории (текст и изображения), которые видны пользователю во вкладке «Theory» при прохождении квиза.
- Кнопки **Text** и **Image** добавляют новый блок.
- **Текст**: поле с текстом (поддерживается разметка).
- **Изображение**: поле для URL или кнопка **Upload** — загрузка файла в хранилище, ссылка подставляется автоматически.
- Стрелки вверх/вниз меняют порядок блоков. Иконка корзины **удаляет блок сразу после подтверждения**; если это изображение из хранилища, файл там тоже удаляется.
- Изменения по теории (добавление и правка блоков) сохраняются кнопкой **Save changes** на вкладке «Details and pages»; удаление блоков теории выполняется сразу при подтверждении.

---

## Удаление и сохранение

| Действие | Когда применяется |
|----------|-------------------|
| Удаление страницы, вопроса, варианта, блока теории | **Сразу после подтверждения** в диалоге (запись в БД удаляется; для изображений теории — и файл в хранилище). |
| Создание и редактирование (тексты, добавление страниц/вопросов/вариантов/блоков теории) | По нажатию **Save changes** (редактирование) или **Create quiz** (создание). |

---

## Краткая памятка

| Что настраиваете | Где | Обязательно |
|------------------|-----|-------------|
| Название квиза | Quiz title | Да |
| Описание | Description | Нет |
| Теория (текст/изображения) | Вкладка Theory / блок Theory (optional) | Нет |
| Тип ответов на странице | Page type: Single / Multiple / Text input / Dropdown in gaps / Matching | Да |
| Заголовок страницы | Page title | Нет |
| Текст вопроса | Question text (для input/dropdown — с `[[]]` где пропуски) | Да |
| Пояснение после ответа | Explanation | Нет |
| Варианты (single/multiple) | Options + Correct | Минимум один вариант, хотя бы один Correct |
| Допустимые ответы (text input) | Correct answers по каждому пропуску | Минимум один правильный ответ на пропуск |
| Варианты по пропускам (dropdown) | Options for gap N + Correct | Минимум один вариант и один Correct на пропуск |
| Пары (matching) | Right column + Left column | Одна пара (вопрос справа + элемент слева) на строку |

Если при сохранении появляется ошибка — проверьте, что заполнены все обязательные поля, у вопросов с выбором отмечен хотя бы один правильный вариант, у текстовых/пропусков — хотя бы один правильный ответ на каждый пропуск, у matching — пара для каждой строки.
