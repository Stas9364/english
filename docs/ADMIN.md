# Создание квизов и страниц с ответами

Пошаговое руководство: как устроен квиз, как добавлять страницы, теорию и настраивать ответы.

---

## Как устроен квиз

- **Квиз** — это один тест (например, «Present Simple»).
- У квиза есть **название** и **описание** (описание показывается пользователю в начале).
- Квиз может содержать **теорию** — блоки текста и/или изображений, которые отображаются пользователю во вкладке «Theory» до или во время прохождения теста.
- Квиз состоит из **страниц**. Каждая страница — это один экран с заданиями.
- На каждой странице задаётся **тип ответа**: один вариант, несколько вариантов или ввод текста.
- Внутри страницы — **вопросы**. У каждого вопроса свой текст и свои варианты ответов (или список правильных фраз для текстового ввода).

Схема: **Квиз → (опционально) Теория + Страницы → У каждой страницы тип + вопросы → У каждого вопроса варианты или правильные ответы**.

---

## Создание нового квиза

### Шаг 1. Основные поля

- **Quiz title** (обязательно) — название квиза, например «Present Simple». Оно отображается на главной и в начале теста.
- **Description (optional)** — краткое описание или инструкция. Показывается пользователю перед началом и при необходимости на странице.

### Шаг 2. Страницы

Под полями квиза идёт блок **Pages**.

- У каждой страницы есть карточка **Page 1**, **Page 2** и т.д.
- Страниц должно быть **хотя бы одна**. Добавление новой страницы — кнопка **Add page** внизу блока «Pages».

В каждой карточке страницы настраивается:

1. **Page type** — тип ответов на этой странице:
   - **Single choice** — один правильный вариант (радиокнопки).
   - **Multiple choice** — несколько правильных вариантов (чекбоксы).
   - **Text input** — пользователь вводит текст; правильность проверяется по списку допустимых ответов.
2. **Page title (optional)** — подзаголовок страницы, если нужен.
3. **Questions** — список вопросов на этой странице (см. ниже).

Иконка корзины рядом с заголовком страницы **удаляет страницу сразу после подтверждения** (запись удаляется в БД). Удалить можно только если страниц больше одной.

### Шаг 3. Вопросы внутри страницы

Внутри каждой страницы — блок **Questions**.

- Вопросов на странице должно быть **хотя бы один**.
- Новый вопрос — кнопка **Add question** внизу блока вопросов этой страницы.

У каждого вопроса заполняете:

- **Question text** (обязательно) — текст вопроса, например «Choose the correct form».
- **Explanation (optional)** — пояснение, которое показывается пользователю после проверки ответа.

Иконка корзины рядом с «Question 1», «Question 2» **удаляет вопрос сразу после подтверждения**. Удалить можно только если вопросов больше одного.

### Шаг 4. Варианты ответов (Single choice и Multiple choice)

Если у страницы тип **Single choice** или **Multiple choice**, у каждого вопроса есть блок **Options**.

- Каждый вариант — это поле с текстом и чекбокс **Correct**.
- **Single choice**: отметьте **Correct** только у одного варианта — это и будет правильный ответ.
- **Multiple choice**: отметьте **Correct** у всех вариантов, которые считаются правильными; пользователь должен выбрать все правильные.
- Кнопка **Add option** внизу списка вариантов добавляет новый вариант. Иконка корзины рядом с вариантом **удаляет его сразу после подтверждения**. Вариантов должно остаться **минимум один**.
- У каждого вопроса свой набор вариантов; они не связаны с другими вопросами.

### Шаг 5. Правильные ответы для Text input

Если у страницы тип **Text input**, у каждого вопроса вместо вариантов выбора показывается блок **Correct answers (any match counts)**.

- Это список **допустимых правильных фраз**. Пользователь вводит ответ в поле; если введённый текст совпадает с одним из этих фраз (без учёта регистра и лишних пробелов), ответ засчитывается как верный.
- Добавление варианта — кнопка **Add correct answer**. В каждое поле введите один допустимый ответ (например, «have» и «has» — оба будут считаться правильными).
- Иконка корзины **удаляет строку сразу после подтверждения**. Должен остаться **хотя бы один** правильный ответ.
- Можно указать несколько формулировок, если подходят разные написания или синонимы.

### Шаг 6. Теория (опционально)

Блок **Theory (optional)** позволяет добавить к квизу блоки теории до сохранения.

- Кнопки **Text** и **Image** добавляют блок: текстовый или с изображением.
- **Текст**: введите или вставьте текст в поле (поддерживается разметка).
- **Изображение**: нажмите **Upload** и выберите файл (JPEG, PNG, GIF, WebP) — он загрузится в хранилище и ссылка подставится автоматически; либо вставьте готовый URL в поле.
- Стрелки вверх/вниз меняют порядок блоков, иконка корзины **удаляет блок сразу после подтверждения** (для изображений из хранилища файл тоже удаляется).
- Теорию можно не заполнять при создании и добавить позже в режиме редактирования.

### Шаг 7. Сохранение

Нажмите **Create quiz**. После успешного сохранения появится сообщение «Quiz created successfully», форма очистится, а новый квиз появится в списке «Your quizzes» и на главной странице сайта.

---

## Редактирование квиза

1. На странице `/admin` в блоке **Your quizzes** нажмите иконку карандаша у нужного квиза.
2. Откроется форма редактирования с **двумя вкладками**: **Details and pages** и **Theory**.

### Вкладка «Details and pages»

- Поля **Quiz title**, **Description**, **Slug** (адрес квиза, например `/quiz/present-simple`).
- Блок **Pages** — как при создании: тип страницы, заголовок, вопросы, варианты ответов или правильные ответы для Text input.
- **Add page** / **Add question** / **Add option** (или **Add correct answer**) — добавление элементов.
- Иконки корзины **удаляют страницу, вопрос или вариант сразу после подтверждения** (изменения в БД и, для изображений теории, в хранилище применяются немедленно).
- Кнопка **Save changes** сохраняет изменения в названии, описании, slug, страницах и блоках теории (создание и редактирование). Удаления выполняются сразу при подтверждении, отдельно сохранять их не нужно.

### Вкладка «Theory»

- Блоки теории (текст и изображения), которые видны пользователю во вкладке «Theory» при прохождении квиза.
- Кнопки **Text** и **Image** добавляют новый блок.
- **Текст**: поле с текстом (поддерживается разметка).
- **Изображение**: поле для URL или кнопка **Upload** — загрузка файла в хранилище, ссылка подставляется автоматически.
- Стрелки вверх/вниз меняют порядок блоков. Иконка корзины **удаляет блок сразу после подтверждения**; если это изображение из хранилища, файл там тоже удаляется.
- Изменения по теории (добавление и правка блоков) сохраняются кнопкой **Save changes** на вкладке «Details and pages»; удаление блоков теории выполняется сразу при подтверждении.

---

## Удаление и сохранение

| Действие | Когда применяется |
|----------|-------------------|
| Удаление страницы, вопроса, варианта, блока теории | **Сразу после подтверждения** в диалоге (запись в БД удаляется; для изображений теории — и файл в хранилище). |
| Создание и редактирование (тексты, добавление страниц/вопросов/вариантов/блоков теории) | По нажатию **Save changes** (редактирование) или **Create quiz** (создание). |

---

## Краткая памятка

| Что настраиваете | Где | Обязательно |
|------------------|-----|-------------|
| Название квиза | Quiz title | Да |
| Описание | Description | Нет |
| Теория (текст/изображения) | Вкладка Theory / блок Theory (optional) | Нет |
| Тип ответов на странице | Page type: Single / Multiple / Text input | Да |
| Заголовок страницы | Page title | Нет |
| Текст вопроса | Question text | Да |
| Пояснение после ответа | Explanation | Нет |
| Варианты (single/multiple) | Options + Correct | Минимум один вариант, хотя бы один Correct |
| Допустимые ответы (text input) | Correct answers | Минимум один правильный ответ |

Если при сохранении появляется ошибка — проверьте, что заполнены все обязательные поля и что у каждого вопроса с выбором вариантов отмечен хотя бы один правильный вариант, а у текстовых вопросов указан хотя бы один правильный ответ.
